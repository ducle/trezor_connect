trezor_connect.admin:
  path: '/admin/config/people/trezor-connect'
  defaults:
    _form: '\Drupal\trezor_connect\Form\SettingsForm'
    _title: 'TREZOR Connect'
  requirements:
    _permission: 'administer authentication device settings'
trezor_connect.user.register:
  path: '/user/register/trezor/{js}'
  defaults:
    _controller: '\Drupal\trezor_connect\Controller\TrezorConnectController::userRegister'
  requirements:
    _permission: 'register with authentication device'
    js: 'nojs|ajax'
    #_csrf_token: 'TRUE'
trezor_connect.user.login:
  path: '/user/login/trezor/{js}'
  defaults:
    _controller: '\Drupal\trezor_connect\Controller\TrezorConnectController::userLogin'
  requirements:
    _permission: 'login with authentication device'
    js: 'nojs|ajax'
    #_csrf_token: 'TRUE'
trezor_connect.user.manage:
  path: '/user/{user}/trezor-connect'
  defaults:
    _title: 'Authentication Device'
    _form: '\Drupal\trezor_connect\Form\ManageForm'
  requirements:
    user: \d+
    _access_authentication_device: 'TRUE'
trezor_connect.user.manage.js:
  path: '/user/{user}/trezor-connect/{js}'
  defaults:
    _controller: '\Drupal\trezor_connect\Controller\TrezorConnectController::userManage'
  requirements:
    user: \d+
    js: 'nojs|ajax'
    _access_authentication_device: 'TRUE'
    # TODO: Fix csrf tokens
    #_csrf_token: 'TRUE'
trezor_connect.user.manage.disable:
  path: '/user/{user}/trezor-connect/disable'
  defaults:
    _title: 'Disable Authentication Device'
    _form: '\Drupal\trezor_connect\Form\DisableForm'
  requirements:
    #_permission: 'disable authentication device'
    user: \d+
    _access_authentication_device: 'TRUE'
    #_csrf_token: 'TRUE'
trezor_connect.user.manage.remove:
  path: '/user/{user}/trezor-connect/remove'
  defaults:
    _title: 'Remove Authentication Device'
    _form: '\Drupal\trezor_connect\Form\RemoveForm'
  requirements:
    #_permission: 'remove authentication device'
    user: \d+
    _access_authentication_device: 'TRUE'
    #_csrf_token: 'TRUE'
